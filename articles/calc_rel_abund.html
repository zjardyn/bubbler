<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>2. Calculate relative abundance • bubbler</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2. Calculate relative abundance">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bubbler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/calc_rel_abund.html">2. Calculate relative abundance</a></li>
    <li><a class="dropdown-item" href="../articles/cookbook.html">CookBook</a></li>
    <li><a class="dropdown-item" href="../articles/data_import.html">1. Data Import</a></li>
    <li><a class="dropdown-item" href="../articles/pool_taxa.html">3. Pooling and arranging</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>2. Calculate relative abundance</h1>
            
      

      <div class="d-none name"><code>calc_rel_abund.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://zjardyn.github.io/bubbler/">bubbler</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="relative-abundance">Relative abundance<a class="anchor" aria-label="anchor" href="#relative-abundance"></a>
</h2>
<p>For a given set of samples, relative abundance is calculated as:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Relative abundance</mtext><mo>=</mo><mfrac><msub><mi>x</mi><mi>i</mi></msub><mrow><mo>∑</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{Relative abundance} = \frac{x_i}{\sum x_i}</annotation></semantics></math></p>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>
is the count of a given asv, divided by the sum of all asv counts. This
way, the sum of all relative abundances equal one.</p>
<p>It is useful to visualize your data in this form to see the
proportional counts between samples.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span>
<span><span class="co"># path to qiime-formatted asv counts </span></span>
<span><span class="va">counts_q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"qiime"</span>, <span class="st">"table-dada2.qza"</span>, package <span class="op">=</span> <span class="st">"bubbler"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># path to qiime-formatted taxonomy data </span></span>
<span><span class="va">taxa_q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"qiime"</span>, <span class="st">"taxonomy.qza"</span>, package <span class="op">=</span> <span class="st">"bubbler"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># path to qiime-formatted metadata</span></span>
<span><span class="va">metadata_q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"qiime"</span>, <span class="st">"sample-metadata.tsv"</span>, package <span class="op">=</span> <span class="st">"bubbler"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. make rel_abund</span></span>
<span><span class="va">rel_abund</span>  <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/rel_abund_qiime.html">rel_abund_qiime</a></span><span class="op">(</span><span class="va">counts_q</span>, </span>
<span>                               <span class="va">taxa_q</span>, </span>
<span>                               <span class="va">metadata_q</span>,</span>
<span>                               taxa_level <span class="op">=</span> <span class="st">"Genus"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. modify rel_abund</span></span>
<span><span class="va">rel_abund_pool</span> <span class="op">&lt;-</span> <span class="va">rel_abund</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="co"># pool taxa so that only the 12 most abundant taxa are displayed </span></span>
<span>    <span class="fu"><a href="../reference/pool_taxa.html">pool_taxa</a></span><span class="op">(</span>n_taxa <span class="op">=</span> <span class="fl">12</span>, keep_metadata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># 3. plot rel_abund</span></span>
<span><span class="va">rel_abund_pool</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/bar_plot.html">bar_plot</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span> </span>
<span>    <span class="co"># group samples by body site. free_x removes unwanted white space</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">body_site</span>, scales <span class="op">=</span> <span class="st">"free_x"</span> <span class="op">)</span> </span></code></pre></div>
<p><img src="calc_rel_abund_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>Subject proportions on the right palm are vastly different, which
would not be captured in a filled barplot.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rel_abund_pool</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/bar_plot.html">bar_plot</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span>  <span class="op">+</span> </span>
<span>    <span class="co"># group samples by body site. free_x removes unwanted white space</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">body_site</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="calc_rel_abund_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>This is the effect of calculating rel_abund separately so that each
sample sums to one. We can scale our relative abundances to one within
<code>bar_plot</code> using the position argument. We can also
precompute the grouped relative abundances in our table:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rel_abund_qiime.html">rel_abund_qiime</a></span><span class="op">(</span><span class="va">counts_q</span>, </span>
<span>                <span class="va">taxa_q</span>,</span>
<span>                <span class="va">metadata_q</span>,</span>
<span>                taxa_level <span class="op">=</span> <span class="st">"Genus"</span>,</span>
<span>                var <span class="op">=</span> <span class="st">"sample_id"</span><span class="op">)</span> <span class="co"># set the grouping variable to sample_id</span></span></code></pre></div>
<p>Our relative abundances “stack” to one. By filling the plotting area,
we get a better representation of the between-sample composition, at the
cost of obfuscating the between-sample proportions.</p>
<div class="section level3">
<h3 id="visualizing-variables">Visualizing variables<a class="anchor" aria-label="anchor" href="#visualizing-variables"></a>
</h3>
<p><code>bubbler</code> allows you to focus on any metadata variable in
your relative abundance table. Say you wanted to look at relative
abundance across <code>body_site</code>, rather than
<code>sample_id</code> on the x-axis. This can be done by modifying the
<code>x_var</code> argument of <code>bar_plot</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rel_abund_qiime.html">rel_abund_qiime</a></span><span class="op">(</span><span class="va">counts_q</span>,</span>
<span>                <span class="va">taxa_q</span>,</span>
<span>                <span class="va">metadata_q</span>,</span>
<span>                taxa_level <span class="op">=</span> <span class="st">"Genus"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/pool_taxa.html">pool_taxa</a></span><span class="op">(</span>n_taxa <span class="op">=</span> <span class="fl">12</span>,</span>
<span>              keep_metadata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/arrange_taxa.html">arrange_taxa</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/bar_plot.html">bar_plot</a></span><span class="op">(</span>x_var <span class="op">=</span> <span class="st">"body_site"</span><span class="op">)</span></span></code></pre></div>
<p><img src="calc_rel_abund_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>Again, this plot could be scaled in two ways:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute in rel_abund</span></span>
<span><span class="fu"><a href="../reference/rel_abund_qiime.html">rel_abund_qiime</a></span><span class="op">(</span><span class="va">counts_q</span>,</span>
<span>                <span class="va">taxa_q</span>,</span>
<span>                <span class="va">metadata_q</span>,</span>
<span>                taxa_level <span class="op">=</span> <span class="st">"Genus"</span>,</span>
<span>                var <span class="op">=</span> <span class="st">"body_site"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co">#  scaling by body_site</span></span>
<span>    <span class="fu"><a href="../reference/pool_taxa.html">pool_taxa</a></span><span class="op">(</span>n_taxa <span class="op">=</span> <span class="fl">12</span>,</span>
<span>              keep_metadata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/arrange_taxa.html">arrange_taxa</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/bar_plot.html">bar_plot</a></span><span class="op">(</span>x_var <span class="op">=</span> <span class="st">"body_site"</span><span class="op">)</span> <span class="co"># setting body_site as x_var</span></span>
<span></span>
<span><span class="co"># scale in plot</span></span>
<span><span class="fu"><a href="../reference/rel_abund_qiime.html">rel_abund_qiime</a></span><span class="op">(</span><span class="va">counts_q</span>,</span>
<span>                <span class="va">taxa_q</span>,</span>
<span>                <span class="va">metadata_q</span>,</span>
<span>                taxa_level <span class="op">=</span> <span class="st">"Genus"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/pool_taxa.html">pool_taxa</a></span><span class="op">(</span>n_taxa <span class="op">=</span> <span class="fl">12</span>,</span>
<span>              keep_metadata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/arrange_taxa.html">arrange_taxa</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/bar_plot.html">bar_plot</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span>, x_var <span class="op">=</span> <span class="st">"body_site"</span><span class="op">)</span>  <span class="co"># setting position as fill</span></span></code></pre></div>
<p>Generally, if you intend to modify your relative abundance table
e.i., selecting columns, filtering rows, then you shouldn’t use grouped
relative abundance because you may want to keep the true proportional
information. In this case you will rely on <code>position</code> = “fill
in <code><a href="../reference/bar_plot.html">bubbler::bar_plot</a></code>.</p>
<p>The grouped relative abundance is calculated as:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Grouped relative abundance</mtext><mo>=</mo><mfrac><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{Grouped relative abundance} = \frac{x_{ij}}{\sum_{j=1}^{k} x_{ij}}</annotation></semantics></math></p>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
is the levels of the grouping variable. Within each level of the
grouping variable, the sum of relative abundance equals one.</p>
</div>
<div class="section level3">
<h3 id="showing-both-scaled-and-unscaled-information-">Showing both scaled and unscaled information.<a class="anchor" aria-label="anchor" href="#showing-both-scaled-and-unscaled-information-"></a>
</h3>
<p>If you want the best of both worlds, you can create a scaled bar
plot, and superimpose the proportional abundances. Currently, this
feature does not work with a faceting functions, so the only option
would be to split a rel_abund table into multiple plots.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># order by sample read abundance, plot as line</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">counts_q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"qiime"</span>, <span class="st">"table-dada2.qza"</span>, package <span class="op">=</span> <span class="st">"bubbler"</span><span class="op">)</span></span>
<span><span class="va">taxa_q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"qiime"</span>, <span class="st">"taxonomy.qza"</span>, package <span class="op">=</span> <span class="st">"bubbler"</span><span class="op">)</span></span>
<span><span class="va">metadata_q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"qiime"</span>, <span class="st">"sample-metadata.tsv"</span>, package <span class="op">=</span> <span class="st">"bubbler"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rel_abund_qiime.html">rel_abund_qiime</a></span><span class="op">(</span></span>
<span>    asv_qiime <span class="op">=</span> <span class="va">counts_q</span>,</span>
<span>    taxa_qiime <span class="op">=</span> <span class="va">taxa_q</span>,</span>
<span>    metadata_qiime <span class="op">=</span> <span class="va">metadata_q</span>,</span>
<span>    taxa_level <span class="op">=</span> <span class="st">"Genus"</span>, <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/pool_taxa.html">pool_taxa</a></span><span class="op">(</span>n_taxa <span class="op">=</span> <span class="fl">8</span>, keep_metadata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/arrange_taxa.html">arrange_taxa</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/arrange_var.html">arrange_var</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="st">"body_site"</span><span class="op">)</span></span>
<span>    <span class="co"># arrange_var_abund(flip = TRUE)</span></span>
<span></span>
<span><span class="va">yes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_rel_abund.html">subset_rel_abund</a></span><span class="op">(</span><span class="va">q</span>, var <span class="op">=</span> <span class="st">"reported_antibiotic_usage"</span>, selection <span class="op">=</span> <span class="st">"Yes"</span><span class="op">)</span></span>
<span><span class="va">no</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_rel_abund.html">subset_rel_abund</a></span><span class="op">(</span><span class="va">q</span>, var <span class="op">=</span> <span class="st">"reported_antibiotic_usage"</span>, selection <span class="op">=</span> <span class="st">"No"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bar_plot.html">bar_plot</a></span><span class="op">(</span><span class="va">yes</span>, position <span class="op">=</span> <span class="st">"fill"</span> ,true_line <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Antibiotics used"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bar_plot.html">bar_plot</a></span><span class="op">(</span><span class="va">no</span>, position <span class="op">=</span> <span class="st">"fill"</span> ,true_line <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Antibiotics not used"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span>, axes <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="calc_rel_abund_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rel_abund_phy.html">rel_abund_phy</a></span><span class="op">(</span><span class="va">physeq</span>, meta_data <span class="op">=</span> <span class="cn">TRUE</span>, taxa_level <span class="op">=</span> <span class="st">"Genus"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/pool_taxa.html">pool_taxa</a></span><span class="op">(</span>n_taxa <span class="op">=</span> <span class="fl">12</span>, keep_metadata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/arrange_taxa.html">arrange_taxa</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/arrange_var_abund.html">arrange_var_abund</a></span><span class="op">(</span>flip <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/bar_plot.html">bar_plot</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span>, true_line <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"turbo"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: phyloseq</span></span>
<span><span class="co">#&gt; Warning: There was 1 warning in `dplyr::mutate()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> In argument: `taxon = forcats::fct_relevel(taxon, "Unclassified", after =</span></span>
<span><span class="co">#&gt;   1)`.</span></span>
<span><span class="co">#&gt; Caused by warning:</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> 1 unknown level in `f`: Unclassified</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">fill</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">fill</span>, which will replace the existing scale.</span></span></code></pre></div>
<p><img src="calc_rel_abund_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zjardyn Liera-Hood.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
